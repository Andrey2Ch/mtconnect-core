# ADAM-6050 PoC Plan
## Proof of Concept: Замена Advantech.Adam.DLL на Node.js + jsmodbus

### 🎯 Цель
Проверить возможность замены проприетарной `.NET DLL` на открытое Node.js решение для работы с ADAM-6050 модулем ввода/вывода через Modbus TCP.

### 📋 Границы PoC
| Контур | Задача | Критерий успеха |
|--------|--------|-----------------|
| **Modbus Client** | Считать 16 входов + 16 выходов каждые 100ms | Стабильные биты 0/1 без пропусков |
| **JSON Mapper** | Преобразовать в структуру `{ts, moduleId, ch0…ch15}` | Валидный JSON с таймстампами |
| **HTTP Outbox** | Отправить батчи в Cloud API | Успешная доставка 95%+ |
| **Mock Mode** | Работа без физического устройства | Все тесты проходят |

### 🛠 Технический стек
- **Node.js 18** + TypeScript
- **jsmodbus** — Modbus TCP клиент
- **axios** — HTTP клиент для Cloud API
- **rxjs** — Reactive streams для обработки данных
- **jest** — Тестирование
- **Docker** — Контейнеризация

### 🏗 Архитектура
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   ADAM-6050     │    │   Node.js PoC   │    │   Cloud API     │
│   (192.168.1.100│───▶│   Edge Gateway   │───▶│   (Railway)     │
│   :502)         │    │                 │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
        │                       │                       │
        │                       │                       │
   16 DI + 16 DO         100ms polling              Batch HTTP POST
                        JSON mapping                /api/ext/data
                        Outbox pattern
```

### 📊 Критерии успеха
1. **Подключение**: Стабильное Modbus TCP соединение
2. **Производительность**: 10+ операций/сек без задержек
3. **Надежность**: Обработка обрывов связи + retry
4. **Совместимость**: Тот же JSON формат, что и vfGateway
5. **Тестируемость**: Mock-сервер для CI/CD

### 🚀 План реализации (6 задач)
1. **Проектная структура** — TypeScript + Docker setup
2. **Modbus клиент** — jsmodbus интеграция
3. **JSON маппер** — Структуры данных
4. **HTTP клиент** — Cloud API интеграция
5. **Mock сервер** — Тестирование без железа
6. **Интеграционные тесты** — Полный цикл + CI/CD

### 💡 Преимущества замены
- **Открытый код** — нет зависимости от Advantech SDK
- **Кроссплатформенность** — Linux/Windows/MacOS
- **Современные инструменты** — TypeScript, async/await
- **Лучшая тестируемость** — Mock-серверы, unit-тесты
- **Унификация** — один стек для всего проекта

### ⚠️ Риски
- **Производительность** — проверить latency vs .NET DLL
- **Совместимость** — убедиться что ADAM-6050 поддерживает стандартный Modbus TCP
- **Стабильность** — проверить работу 24/7 без перезапусков

### 📈 Дальнейшие шаги после PoC
Если PoC успешен:
1. Интеграция в основной MTConnect проект
2. Добавление поддержки других Modbus устройств
3. Развертывание в продакшен с мониторингом
4. Документация миграции с vfGateway 